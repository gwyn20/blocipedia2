<h1>Edit Wiki</h1>

<div class="row">
  
  <div class="col-md-8">
    <%= form_for @wiki do |f| %>
      <div class="form-group">
        <%= f.label :title %>
        <%= f.text_field :title, class: 'form-control', placeholder: "Enter wiki title" %>
      </div>
      <div class="form-group">
        <%= f.label :body %>
        <%= f.text_area :body, rows: 8, class: 'form-control', placeholder: "Enter wiki body" %>
          <div class="markdown_option">
            Feel free to use <a href="https://guides.github.com/features/mastering-markdown/" target="_blank"><b>Markdown Syntax</b></a>
          </div>
      </div>
      <% if current_user.admin? || current_user.premium? %>
      <div class="form-group">
        <%= f.label :private, class: 'checkbox' do %>
          <%= f.check_box :private %> Private wiki
        <% end %>
      </div>
    <% end %> 
      <div class="form-group">
        <%= f.submit "Save", class: 'btn btn-primary' %>
      </div>
    <% end %>
  </div>
</div>

<div class="form-group">
  <div class="col-md-8">
    <h3>Collaborators</h3>
    <% collaborator_ids = @wiki.collaborator_ids %>
    <% User.all.each do |user| %>
      <div class="user">
        <%= check_box_tag "wiki[collaborator_ids][]", user.id, collaborator_ids.include?(user.id) %>
        <%= user.email %>
      </div>
    <% end %>
  </div>
</div>

<% if current_user.premium? || current_user.admin? %>
  <h3>Add Collaborators</h3>

  <%= form_for [@wiki, Collaborator.new] do |collaborator| %>
    <%= email_field_tag :collaborator %>
    <%= collaborator.submit "Add Collaborator", class: 'btn btn-primary' %>
  <% end %>

  <h3>Remove Collaborators</h3>

  <% @wiki.collaborators.each do |collaborator| %>
    <% user = User.find(collaborator.user_id) %>
    <%= user.email %>
        <%= link_to "Remove", wiki_collaborator_path(@wiki, collaborator), class: 'btn btn-danger', method: :delete%>
  <% end %>
<% end %>
